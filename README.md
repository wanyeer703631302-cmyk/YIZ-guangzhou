# YIZ Gallery - 3Då›¾ç‰‡ç”»å»Š

ä¸€ä¸ªå…¨æ ˆ3Då›¾ç‰‡ç”»å»Šåº”ç”¨ï¼Œå…·æœ‰ç½‘æ ¼ç•¸å˜æ•ˆæœã€ç”¨æˆ·è®¤è¯ã€å›¾ç‰‡ä¸Šä¼ å’Œäº¤äº’åŠŸèƒ½ã€‚

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- **React 18** + TypeScript
- **Vite** - å¿«é€Ÿæ„å»ºå·¥å…·
- **Three.js** - 3Dæ¸²æŸ“å¼•æ“
- **TailwindCSS** + shadcn/ui - UIç»„ä»¶åº“
- **Framer Motion** - åŠ¨ç”»åº“

### åç«¯
- **Vercel Serverless Functions** - APIç«¯ç‚¹
- **Express.js** + TypeScript - åç«¯æ¡†æ¶
- **Prisma ORM** - æ•°æ®åº“ORM
- **PostgreSQL** - å…³ç³»å‹æ•°æ®åº“
- **Cloudinary** - å›¾ç‰‡å­˜å‚¨å’ŒCDN
- **JWT** - ç”¨æˆ·è®¤è¯

## é¡¹ç›®ç»“æ„

```
project-root/
â”œâ”€â”€ app/                          # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/          # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ hooks/               # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ lib/                 # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ services/            # APIæœåŠ¡å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts          # APIå®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts         # è®¤è¯æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ upload.ts       # ä¸Šä¼ æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ types/               # TypeScriptç±»å‹
â”‚   â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ public/                  # é™æ€èµ„æº
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ api/                          # Serverless Functions
â”‚   â”œâ”€â”€ assets.ts                # èµ„æºç®¡ç†API
â”‚   â”œâ”€â”€ auth.ts                  # è®¤è¯API
â”‚   â”œâ”€â”€ health.ts                # å¥åº·æ£€æŸ¥
â”‚   â”œâ”€â”€ likes.ts                 # ç‚¹èµAPI
â”‚   â”œâ”€â”€ favorites.ts             # æ”¶è—API
â”‚   â””â”€â”€ upload.ts                # ä¸Šä¼ API
â”‚
â”œâ”€â”€ prisma/                       # æ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ schema.prisma            # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ migrations/              # è¿ç§»è„šæœ¬
â”‚
â”œâ”€â”€ lib/                          # å…±äº«åº“
â”‚   â”œâ”€â”€ prisma.ts                # Prismaå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ cloudinary.ts            # Cloudinaryé…ç½®
â”‚   â””â”€â”€ auth.ts                  # è®¤è¯å·¥å…·
â”‚
â”œâ”€â”€ .env.example                  # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ vercel.json                   # Vercelé…ç½®
â”œâ”€â”€ package.json                  # æ ¹package.json
â””â”€â”€ README.md
```

## åŠŸèƒ½ç‰¹æ€§

- âœ¨ **3Dç½‘æ ¼ç•¸å˜æ•ˆæœ** - åŸºäºThree.jsçš„ç‚«é…·3Då±•ç¤º
- ğŸ–¼ï¸ **å›¾ç‰‡ä¸Šä¼ ** - æ”¯æŒæ‹–æ‹½ä¸Šä¼ ï¼Œè‡ªåŠ¨ä¸Šä¼ åˆ°Cloudinary
- ğŸ‘¤ **ç”¨æˆ·è®¤è¯** - JWTä»¤ç‰Œè®¤è¯ï¼Œå®‰å…¨å¯é 
- â¤ï¸ **ç‚¹èµå’Œæ”¶è—** - ç”¨æˆ·äº¤äº’åŠŸèƒ½ï¼Œæ•°æ®æŒä¹…åŒ–
- ğŸ“± **å“åº”å¼è®¾è®¡** - é€‚é…å„ç§å±å¹•å°ºå¯¸
- ğŸš€ **Serverlessæ¶æ„** - åŸºäºVercelçš„æ— æœåŠ¡å™¨éƒ¨ç½²

## ç¯å¢ƒå˜é‡é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼Œå‚è€ƒ `.env.example`ï¼š

```env
# æ•°æ®åº“è¿æ¥
DATABASE_URL="postgresql://user:password@host:5432/database?schema=public"

# Cloudinaryé…ç½®
CLOUDINARY_CLOUD_NAME="your_cloud_name"
CLOUDINARY_API_KEY="your_api_key"
CLOUDINARY_API_SECRET="your_api_secret"

# JWTå¯†é’¥ï¼ˆç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼‰
JWT_SECRET="your_jwt_secret_key_here"

# å‰ç«¯APIåœ°å€ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
VITE_API_URL="http://localhost:3000/api"
```

### è·å–é…ç½®ä¿¡æ¯

1. **PostgreSQLæ•°æ®åº“**
   - æ¨èä½¿ç”¨ [Vercel Postgres](https://vercel.com/docs/storage/vercel-postgres)
   - æˆ–ä½¿ç”¨ [Supabase](https://supabase.com/)ã€[Railway](https://railway.app/) ç­‰æœåŠ¡

2. **Cloudinaryè´¦å·**
   - è®¿é—® [Cloudinary](https://cloudinary.com/) æ³¨å†Œå…è´¹è´¦å·
   - åœ¨Dashboardä¸­æ‰¾åˆ°Cloud Nameã€API Keyå’ŒAPI Secret

3. **JWTå¯†é’¥**
   - ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ï¼š`node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"`

## æœ¬åœ°å¼€å‘

### 1. å®‰è£…ä¾èµ–

```bash
npm install
cd app && npm install && cd ..
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å†™é…ç½®ä¿¡æ¯ï¼š

```bash
cp .env.example .env
```

### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç”ŸæˆPrismaå®¢æˆ·ç«¯
npm run prisma:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
npm run prisma:migrate:dev

# ï¼ˆå¯é€‰ï¼‰æ‰“å¼€Prisma StudioæŸ¥çœ‹æ•°æ®
npm run prisma:studio
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# åŒæ—¶å¯åŠ¨å‰ç«¯å’Œåç«¯
npm run dev

# æˆ–åˆ†åˆ«å¯åŠ¨
npm run dev:frontend  # å‰ç«¯: http://localhost:5173
npm run dev:api       # åç«¯: http://localhost:3000
```

### 5. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—® [http://localhost:5173](http://localhost:5173)

## æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œæµ‹è¯•å¹¶ç›‘å¬æ–‡ä»¶å˜åŒ–
npm run test:watch

# è¿è¡Œå±æ€§æµ‹è¯•
npm run test:property

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

## éƒ¨ç½²åˆ°Vercel

### 1. å‡†å¤‡å·¥ä½œ

ç¡®ä¿ä½ å·²ç»ï¼š
- åˆ›å»ºäº†Vercelè´¦å·
- å®‰è£…äº†Vercel CLIï¼š`npm i -g vercel`
- å‡†å¤‡å¥½äº†PostgreSQLæ•°æ®åº“
- å‡†å¤‡å¥½äº†Cloudinaryè´¦å·

### 2. é…ç½®ç¯å¢ƒå˜é‡

åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `DATABASE_URL` | PostgreSQLè¿æ¥å­—ç¬¦ä¸² | `postgresql://...` |
| `CLOUDINARY_CLOUD_NAME` | Cloudinaryäº‘åç§° | `your_cloud_name` |
| `CLOUDINARY_API_KEY` | Cloudinary APIå¯†é’¥ | `123456789012345` |
| `CLOUDINARY_API_SECRET` | Cloudinary APIå¯†é’¥ | `abcdefghijklmnop` |
| `JWT_SECRET` | JWTç­¾åå¯†é’¥ | `random_secret_key` |

### 3. éƒ¨ç½²

```bash
# é¦–æ¬¡éƒ¨ç½²
vercel

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
vercel --prod
```

### 4. è¿è¡Œæ•°æ®åº“è¿ç§»

éƒ¨ç½²åï¼Œåœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­è¿è¡Œï¼š

```bash
npm run prisma:migrate
```

æˆ–è€…ä½¿ç”¨Vercel CLIï¼š

```bash
vercel env pull .env.production
npm run prisma:migrate
```

### 5. éªŒè¯éƒ¨ç½²

è®¿é—®ä½ çš„VercelåŸŸåï¼Œæ£€æŸ¥ï¼š
- å‰ç«¯é¡µé¢æ­£å¸¸åŠ è½½
- APIå¥åº·æ£€æŸ¥ï¼š`https://your-domain.vercel.app/api/health`
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•åŠŸèƒ½
- å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½

## APIç«¯ç‚¹

### å¥åº·æ£€æŸ¥
- `GET /api/health` - æ£€æŸ¥æœåŠ¡çŠ¶æ€

### è®¤è¯
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/auth/session` - è·å–å½“å‰ä¼šè¯

### èµ„æºç®¡ç†
- `GET /api/assets` - è·å–èµ„æºåˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µå’Œç­›é€‰ï¼‰
- `POST /api/upload` - ä¸Šä¼ å›¾ç‰‡ï¼ˆéœ€è¦è®¤è¯ï¼‰

### äº¤äº’åŠŸèƒ½
- `POST /api/likes` - åˆ›å»ºç‚¹èµï¼ˆéœ€è¦è®¤è¯ï¼‰
- `DELETE /api/likes/:id` - åˆ é™¤ç‚¹èµï¼ˆéœ€è¦è®¤è¯ï¼‰
- `POST /api/favorites` - åˆ›å»ºæ”¶è—ï¼ˆéœ€è¦è®¤è¯ï¼‰
- `DELETE /api/favorites/:id` - åˆ é™¤æ”¶è—ï¼ˆéœ€è¦è®¤è¯ï¼‰
- `GET /api/user/interactions` - è·å–ç”¨æˆ·äº¤äº’æ•°æ®ï¼ˆéœ€è¦è®¤è¯ï¼‰

## å¸¸è§é—®é¢˜

### æ•°æ®åº“è¿æ¥å¤±è´¥

ç¡®ä¿ï¼š
1. `DATABASE_URL` æ ¼å¼æ­£ç¡®
2. æ•°æ®åº“æœåŠ¡æ­£åœ¨è¿è¡Œ
3. ç½‘ç»œè¿æ¥æ­£å¸¸
4. å·²è¿è¡Œ `npm run prisma:generate`

### Cloudinaryä¸Šä¼ å¤±è´¥

ç¡®ä¿ï¼š
1. Cloudinaryé…ç½®ä¿¡æ¯æ­£ç¡®
2. APIå¯†é’¥æœ‰æ•ˆ
3. æ–‡ä»¶å¤§å°ä¸è¶…è¿‡10MB
4. æ–‡ä»¶æ ¼å¼ä¸ºå›¾ç‰‡ç±»å‹

### JWTè®¤è¯å¤±è´¥

ç¡®ä¿ï¼š
1. `JWT_SECRET` å·²é…ç½®
2. ä»¤ç‰Œæœªè¿‡æœŸï¼ˆæœ‰æ•ˆæœŸ7å¤©ï¼‰
3. è¯·æ±‚å¤´åŒ…å«æ­£ç¡®çš„Authorizationå­—æ®µ

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„APIç«¯ç‚¹

1. åœ¨ `api/` ç›®å½•åˆ›å»ºæ–°æ–‡ä»¶
2. å¯¼å‡ºé»˜è®¤çš„è¯·æ±‚å¤„ç†å‡½æ•°
3. ä½¿ç”¨ `withAuth` ä¸­é—´ä»¶ä¿æŠ¤éœ€è¦è®¤è¯çš„ç«¯ç‚¹

```typescript
// api/example.ts
import { VercelRequest, VercelResponse } from '@vercel/node'
import { withAuth } from '../lib/auth'

export default withAuth(async (req: VercelRequest, res: VercelResponse) => {
  // å¤„ç†è¯·æ±‚
  res.json({ success: true, data: 'Hello World' })
})
```

### æ·»åŠ æ–°çš„æ•°æ®æ¨¡å‹

1. ç¼–è¾‘ `prisma/schema.prisma`
2. è¿è¡Œ `npm run prisma:migrate:dev`
3. æ›´æ–°TypeScriptç±»å‹å®šä¹‰

### å‰ç«¯è°ƒç”¨API

ä½¿ç”¨ `apiClient` æœåŠ¡ï¼š

```typescript
import { apiClient } from '@/services/api'

// è·å–èµ„æºåˆ—è¡¨
const result = await apiClient.getAssets({ page: 1, limit: 20 })

if (result.success) {
  console.log(result.data)
} else {
  console.error(result.error)
}
```

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤Issueæˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚
